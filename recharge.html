<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <div>
        <select id="providers">
            <option value=""> CHOOSE PROVIDER </option>
            <option value="MTN"> MTN </option>
            <option value="GLO"> GlO</option>
            <option value="9MOBILE"> 9MOBILE</option>
            <option value="AIRTEL"> AIRTEL </option>
        </select>
    </div>

    <br>

    <br>
    <div>
        <select id="amounts">
            <option value=""> CHOOSE AMOUNT </option>
            <option value="100"> 100 </option>
            <option value="200"> 200</option>
            <option value="500"> 500</option>
            <option value="1000"> 1000 </option>
        </select>
    </div>


    <div>
        <p> pin: <span id="pin"> </span></p>
        <button onclick="generatePin()"> generate pin </button>
    </div>


    <div>
        <input type="text" id="card" value="*311*pin#">
        <button onclick="loadCard()">load card</button>
    </div>

    <p> MTN balance: <span id="mtnbalance"> </span></p>
    <p> GLO balance: <span id="globalance"> </span></p>
    <p>AIRTEL balance: <span id="airtelbalance"> </span></p>
    <p> 9MOBILE balance: <span id="9mobilebalance"> </span></p>






</body>

</html>
<script>
    let rechargeCards = []

    let balances = {
        mtnbalance: 0,
        globalance: 0,
        airtelbalance: 0,
        "9mobilebalance": 0,
    }

   function displayBalance() {
    for (const key in balances) { 
       document.getElementById(key).innerHTML = balances[key]
   }
   }

   displayBalance()


    console.log(balances.globalance);
    console.log(balances['globalance']);



    let providers = document.getElementById('providers')
    let amount = document.getElementById('amounts')

    function generatePin() {

        if (providers.value === '' || amount.value === '') {
            alert('all fields are mandatory')
        } else {
            let myPin = ''
            for (let index = 0; index < 12; index++) {
                myPin += Math.floor(Math.random() * 10) // 0-9
            }
            document.getElementById('pin').innerHTML = myPin

            let card = {
                pin: myPin,
                provider: providers.value,
                amount: amount.value,
                hasCardBeenUsed : false
            }


            rechargeCards.push(card)


        }


    }

    function loadCard() {
        let cardPin = card.value.trim().slice(5, 17) //45678098765678
        let foundCard

        if (card.value !== `*311*${cardPin}#`) {
            alert('invalid card format')
        } else {
            // foundCard = checkIfCardIsValid(cardPin)
            for (let index = 0; index < rechargeCards.length; index++) {
                if (rechargeCards[index].pin === cardPin) {
                    foundCard = rechargeCards[index]
                    break
                }
            }

            if (foundCard === undefined) {
                alert('invalid card pin')
            } else if (foundCard.hasCardBeenUsed === true){
                alert('this card has been used')
            }
            
            else {
                alert(`you've successfully recharged ${foundCard.provider} worth N${foundCard.amount}`)
                if (foundCard.provider === 'MTN') {
                    balances.mtnbalance = balances.mtnbalance + Number(foundCard.amount) 
                } else if (foundCard.provider === 'GLO') {
                    balances.globalance = balances.globalance + Number(foundCard.amount)
                }else if (foundCard.provider === 'AIRTEL'){
                    balances.airtelbalance = balances.airtelbalance + Number(foundCard.amount)
                }else{
                    balances['9mobilebalance'] = balances['9mobilebalance'] + Number(foundCard.amount)
                }
                
                foundCard.hasCardBeenUsed = true
                displayBalance()
                console.log(rechargeCards);
                console.log(balances);

            }


        }



    }



    function checkIfCardIsValid(c) {
        for (let index = 0; index < rechargeCards.length; index++) {
            if (rechargeCards[index].pin === c) {
                return rechargeCards[index]
                break
            }
        }

        return undefined

    }



    // if (true && true && false) {

    // }

    // let val = 5

    // val = val + 6


   

    // let arr = [1,2,4,5]
    // // arr.reverse()
    // for (const num of arr) {
    //     console.log(num);
    // }


    




</script>